///////////////////////////////////////////////////////////////////////////
// Precompilled headers
///////////////////////////////////////////////////////////////////////////
#include <pch.hpp>

///////////////////////////////////////////////////////////////////////////
// Headers
///////////////////////////////////////////////////////////////////////////
#include <DB/Cart.hpp>
#include <POS/Product.hpp>



///////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////
// Static
//
///////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////
///
///////////////////////////////////////////////////////////////////////////
auto ::db::Cart::get(
    ::std::string name
) -> ::std::shared_ptr<::db::Products>
{
    if (::std::ifstream ifs("database/cart/"s + name + ".csv"); !ifs.good()) {
        auto db{ ::std::make_shared<::db::Products>(name, "database/cart/") };
        db->executeCode("CREATE TABLE Products("s +
            "ID       INT NOT NULL,"s +
            "NAME     TEXT,"s +
            "PRICE    INT,"s +
            "QUANTITY INT"s +
        ");" );

        return db;
    } else {
        return ::std::make_shared<::db::Products>(name);
    }
}



///////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////
// Constructors
//
///////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////
::db::Cart::Cart(
    ::std::string name,
    ::std::string path
)
    : ::db::Products{ name, path }
{}
